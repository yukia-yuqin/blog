## 单点登录过程
第一步：用户访问应用系统1。后端判断用户是否登录，若没有登录，则返回403（禁止访问），前端识别403则重定向（302）到认证中心去进行认证操作。

第二步：重定向到认证系统（https://cas.com/login?service=xxx/api/login/cas），显示登录界面，用户输入用户名密码。认证系统将用户登录的信息记录到服务器中。

第三步：当认证服务器验证通过之后，根据请求参数service的值，进行重定向，其实就是回到了请求的后端(xxx/api/login/cas?ticket=yyyyy)，同时会携带一个ticket令牌参数。同时会在Cookie中设置一个TGC，该cookie是网站认证系统的cookie，只有访问这个网站才会携带这个cookie过去。

*****注意：这个携带TGC的Cookie是实现CAS单点登录的关键所在！

Cookie中的TGC：向cookie中添加该值的目的是当下次访问认证系统时，浏览器将Cookie中的TGC携带到服务器，服务器根据这个TGC，查找与之对应的TGT。从而判断用户是否登录过了，是否需要展示登录页面。TGT与TGC的关系就像SESSION与Cookie中SESSIONID的关系。
TGT：Ticket Granted Ticket（俗称大令牌，或者说票根，他可以签发ST）
TGC：Ticket Granted Cookie（cookie中的value），存在Cookie中，根据他可以找到TGT。
ST：Service Ticket （小令牌），是TGT生成的，默认是用一次就生效了。也就是上面数字3处的ticket值。

第四步：用户通过认证，前端与后端之间进行正常的访问。

第五步：当用户再次访问后端，由于后端的session中有用户信息，所以就不用经过认证系统认证，就可以直接访问后端了。

第六步：当用户再去访问其他应用系统时，浏览器会带着凭证ticket过去，其他应用系统到认证系统验证凭证，凭证ticket若是有效，将用户信息保存到其他应用系统的session中一份，并告知其他应用系统，用户通过认证。

第七步：用户通过认证，浏览器与网站之间进行正常的访问。

第八步：当用户再次访问其他应用系统，由于其他应用系统的session中有用户信息，所以就不用经过认证系统认证，就可以直接访问其他应用系统了。

## 单点登出过程

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTEyMzA0NDY4MDUsNjQxMzI5MzU4LC0xOT
EwNDE3MjksLTM3ODU5NjczOF19
-->